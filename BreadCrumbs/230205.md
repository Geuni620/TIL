### tanstack query

> useMutation으로 photo Delete 구현 중 캐시가 업데이트에 문제가 생김

```TSX
export const useDeletePhotoListQuery = (): UseMutateFunction<
  void,
  unknown,
  { selectedPhotoIds: string },
  unknown
> => {
  const queryClient = useQueryClient();
  const { mutate } = useMutation(
    ({ selectedPhotoIds }: { selectedPhotoIds: string }) =>
      deletePhotoList({ selectedPhotoIds }),
    {
      onSuccess: (newData) => {
        // queryClient.setQueriesData([queryKeys.photoList], newData); // 자동으로 업데이트 되긴 함.
        queryClient.invalidateQueries([queryKeys.photoList]); // 수동으로 트리거 시켜주어야 캐시가 업데이트 됨.
      },
    },
  );

  return mutate;
};

```

- invalidateQueries가 정상적으로 동작하지 않음
  - photoData를 delete하는 버튼을 클릭하고 난 이후, invalidateQueries가 re-fetch 트리거를 거는 걸로 알고 있는데,
    1. refetch 되지만, 기존 50개의 데이터를 그대로 가져옴
    2. refetch 되지 않고, 수동으로 트리거를(refetchOnWindow) 걸어주면 50개에서 49개로 변경 됨.

아직 해결은 못했음.
