# React useState 선언 스타일

## useState를 여러 개 만드는게 좋을까?

> "근휘님은 state를 여러 개 만드시나요? 아니면 하나만 선언해주고 객체 형태로 작성하시나요?"

<br>

## 렌더링 관점

- 데이터타입을 객체로 state를 만들었을 때 여러 곳에서 데이터 바인딩 될 가능성이 높음.
- 그렇다면 하나의 값이 변경되었을 시, 객체타입의 state가 리렌더링 될 것이고 데이터 바인딩 되어있는 모든 컴포넌트에서 리렌더링 됨.  
  → 비효율적.

<br>

## 불변성 관점

> 불변성 관점에서 대해서 이야기하기 전 스프레드 문법에 대해 궁금해짐

<br>

### 스프레드 문법은 깊은 복사? 얕은 복사?

- 보통 state를 사용할 때 다음과 같이 사용함

```JSX
const App = () => {
  const [state, setState] = useState({
    name: "Keun",
    age: 31,
  });

  setState({...state, name: "Lee"});
};
```

- 여기서 스프레드 문법으로 기존 prevState를 복사 해준 뒤 name을 변경해줬음
- 이렇게 한 이유는 불변성을 유지하기 위해.

<br>

> 그럼 스프레드 문법은 깊은 복사인가요? 얕은 복사 아닌가요?

- 단톡방에서도 물어보고, 주변사람에게도 물어보고, 블로그도 찾아봤지만 결과적으론(내가 지금 찾아본 기준으론) **깊은 복사**가 맞는 것 같음  
  **`이때까진 깊은 복사가 맞는거라고 생각했음`**

* 그 이유는 불변성과도 연관이 있음

<br>

### 스프레드 문법이 얕은복사라면,

- 스프레드 문법이 얕은 복사라면 setState에서 불변성을 유지하며 값을 변경할 수 없음.

* 객체타입으로 예를 들었을 때, 객체는 값에 의한 복사가 아닌 참조에 의한 복사로 구현 됨
  - 즉, setState(...state, name:"Lee")로 state를 업데이트할 시, 복사된 값이 참조에 의한 복사 즉, 얕은복사라면 변경이 이루어질 수 없다고 생각했음.
  - 리렌더링상에서 변경이 되어야 값이 업데이트 될텐데, 이건 참조에 의한 복사라면 메모리상에서 같은 값을 참조하고 있기 때문에 복사해도 어쨌든 state는 같은 메모리 주소를 가리키고 있음.
  - 즉 자신을 자신이 복사하는 모습이라고 이해함.(결국 자기자신)

<br>

### Deep Dive 책에서 본 예시

- Deep Dive 책에는 다음과 같이 적혀있음

```JS
let objA = {
  name: "Keun",
  age: 31,
};

// let objB = {...objA}; // false
let objB = objA; // true

let objC = {
  name: "Keun",
  age: 31,
};

let ObjD = {
  name: "Keun",
  age: 31,
};

console.log(objA === objB); // false
console.log(objA.age === objB.age); // true
console.log(objC === ObjD); // false

let a = "Keun";
let b = a;

console.log(a === b); // true
```

<br>

### 결과적으론 스프레드 문법은 얕은 복사로 구현 됨

조금 헷갈리지만 **`스프레드 문법은 얕은 복사가 맞음`**

- 스프레드 문법의 결과는 값이 아님.
  - 스프레드 문법의 결과는 값이 아니라 값들의 목록임.
  - 그래서 이 값들의 목록을 배열 또는 객체에 담아서 리턴하는 것
- 그렇기 때문에 위에서 깊은 복사 효과가 났던 것 같음.
- 즉 값들의 목록을 얕은 복사로 복사해서 새로운 배열 또는 객체에 담아서 리턴하는 것.

<br>

### 다시 불변성 관점

- 불변성 관점에서 스프레드 문법으로 복사한 것이 새롭게 생성된 객체 또는 배열이기 때문에, 불변성이 유지될 수 있었던 것.

<br>
