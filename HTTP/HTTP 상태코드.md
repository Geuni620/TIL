# HTTP 상태코드

> 상태코드는 1xx, 2xx, 3xx, 4xx, 5xx가 있음  
> 1xx는 거의 사용하지 않음

<br>

## 2xx번대

| 번호 |    의미    |                                  설명                                   |
| :--: | :--------: | :---------------------------------------------------------------------: |
| 200  |    o.k     |                                요청 성공                                |
| 201  |   Create   |                 요청에 성공해서 새로운 리소스가 생성 됨                 |
| 202  |   Accept   |             요청이 접수는 됐는데, 처리가 완료되지 않은 상태             |
| 204  | No Content | 서버가 요청을 성공적으로 수행했는데 응답으로 본문에 보낼 데이터가 없음. |

- 204 같은 경우는 딱 게시글 save를 생각하면 됨.
  - 게시글 쓰고 저장 눌렀을 때 서버에 저장을 잘 되었지만 따로 payload 할 필요 없을 때 사용
- 단, 번호대가 너무 많아지면 복잡해지므로, 팀별로 상의해서 필요한 경우만 사용.
  - 대부분 200 또는 201까지만 사용함.

<br>

## 3xx번대

- 웹 브라우저는 3xx 응답의 결과에 Location header가 있으면, Location 위치로 자동이동(리다이렉트)

* 리 다이렉션에는 크게 3가지가 있음

  1. 영구 리다이렉션
     - 301, 308이 있음(기능이 똑같음, 경로가 완전히 이동)
  2. 일시 리다이렉션
     - 예를들면 주문 완료 후, 주문내역화면으로 일시적으로 이동시키는 것.
     - PRG
  3. 특수 리다이렉션
     - 결과 대신 캐시사용해라는 리다이렉션

<br>

| 번호 |       의미        |                                                  설명                                                   |
| :--: | :---------------: | :-----------------------------------------------------------------------------------------------------: |
| 300  |     거의 안씀     |                                                    -                                                    |
| 301  |  영구 리다이렉션  | 경로가 완전히 바뀌었다는 것을 알려줌, 리다이렉트시 요청 메서드가 Get으로 변하고, 본문이 제거될 수 있음. |
| 302  | 일시적 리다이렉션 |                  리다이렉트시 요청 메서드가 Get으로 변하고 본문이 제거될 수 있음(May)                   |
| 303  | 일시적 리다이렉션 |                        302와 기능은 같음, 리다이렉트시 요청메서드가 Get으로 변경                        |
| 304  |    No Content     |                                                                                                         |
| 305  |    No Content     |                                                                                                         |
| 306  |    No Content     |                                                                                                         |
| 307  | 일시적 리다이렉션 |    302와 기능이 같음, 리다이렉트시 요청 메서드와 본문 유지 (요청 메서드를 변경하면 안된다. Must Not)    |
| 308  |  영구 리다이렉션  |                   301과 기능이 같음, 301과 다른 점 하나는 본문을 유지시켜줌, 잘 안씀.                   |

<br>

### PRG: Post / Redirect / Get

- 일시적 리다이렉트 - 예시
  - Post로 주문 후 웹 브라우저를 새로고침하면?
  - 새로고침은 다시 요청
  - 중복주문이 될 수 있음.
  - 단 이런 부분은 서버에서 잘 막아줘야함.
- 물론 클라이언트도 막아주는게 좋음
  - Post로 주문 후 주문결과 화면을 Get 메서드로 리다이렉트
  - 새로고침해도 결과 화면을 Get으로 조회
  - 중복 주문 대신에 결과 화면만 Get으로 다시 요청

<br>

### 그래서 307, 302, 303 중 무엇을 써야하나요?

- 302는 get으로 변할 수 있음
- 307은 method가 변하면 안됨
- 303은 method가 get으로 변경되어야함.
- 근데 대부분은 get으로 다 바꿔버림
- 그래서 현실적으로는 307, 303을 권장하지만, 이미 302를 기본값으로 많이 사용함.
- 즉, 302를 사용해도 큰 문제가 없다면 302를 쓸 것

<br>

### 기타 다이렉션

- 304
  - 진짜많이씀.
  - 캐시를 목적으로 사용함.
  - 클라이언트에게 리소스가 수정되지 않았음을 알려줌.
  - 따라서, 클라이언트는 로컬PC에 저장된 캐시를 재 사용함.
  - 304 응답은, 응답에 메세지 바디를 포함하면 안된다.
    - 로컬 캐시를 사용해야 하므로
  - 조건부 GET , HEAD 요청시 사용

<br>

## 4xx번대, 5xx번대

### 언제 400을 쓰고 언제 500을 쓰는가?

- 클라이언트가 잘못했음 → 그러면 400대 오류
- 서버가 잘못했음 → 그러면 500대 오류
- 400대 오류는 클라이언트에서 이미 잘못된 요청, 데이터를 보내고 있기 때문에 똑같은 재시도가 실패함
- 500대 오류는 데이터베이스가 복귀되어 같은 요청에도 요청이 성공할 가능성 있음.
  - 즉 400대는 복구 불가능, 500대는 복구 될 수도 있음.

<br>

| 번호 |         의미          |                                              설명                                               |
| :--: | :-------------------: | :---------------------------------------------------------------------------------------------: |
| 400  |      Bad request      |                  클라이언트가 잘못된 요청을 해서 서버가 요청을 처리할 수 없음.                  |
| 401  |     Unauthorized      |                클라이언트가 해당 리소스에 대한 인증이 필요함, 즉 로그인이 필요함                |
| 403  |       Forbidden       | 서버가 요청을 이해했지만 승인을 거부함, 주로 인증 자격 증명은 있지만, 접근 권한이 불충분한 경우 |
| 404  |       Not Found       |                                   요청 리소스를 찾을 수 없음.                                   |
| 500  | Internal Server Error |                                   서버 내부 문제로 오류 발생                                    |
| 503  |  Service Unavailable  |     서비스 이용 불가, 서버가 일시적 과부하 또는 예정된 작업으로 잠시 요청을 처리할 수 없음.     |

- 403 어드민 등급이 아닌 사용자가 로그인은 했지만, 어드민 등급의 리소스에 접근하는 경우.
